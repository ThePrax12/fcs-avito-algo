Алгоритм Knuth–Morris–Pratt
KMP ищет pattern в text, делая так, что индекс i, которым мы идём по text, никогда не уменьшается.
Для pattern заранее строится префикс функция pi,
которая для каждой позиции i хранит длину наибольшего префикса pattern, совпадающего с суффиксом pattern[0..i].
Во время поиска, если произошло несовпадение text[i] и pattern[j],
мы не начинаем сравнение заново, а уменьшаем j до pi[j-1]
(сдвигаем pattern так, чтобы уже совпавшая часть максимально сохранилась).
Если j дошёл до m, найдено вхождение. Добавляем индекс i-m+1 и продолжаем с j = pi[m-1]
(это позволяет находить перекрывающиеся вхождения).


Оценка сложности:

n = len(text), m = len(pattern).
Время:
Построение pi: O(m). Двигаемся по pattern один раз.
Поиск по text: O(n). Индекс i идёт вперёд, j прыгает по pi, суммарно сравнений линейно.
Итоговое время: O(n + m).

Память:

O(m) на массив pi (Не считая список ответов).


